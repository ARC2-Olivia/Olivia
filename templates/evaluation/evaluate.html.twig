{% extends 'evaluation/_base_evaluation.html.twig' %}
{% trans_default_domain 'app' %}

{% block evaluationContent %}
    {% if is_granted('ROLE_MODERATOR') %}

        <h2 class="mb-3">{{ 'evaluation.extra.questions'|trans }}</h2>
        {% if evaluationQuestions is not empty %}
            <ul id="evaluation_questions" class="mod--evaluation-questions" data-path="{{ path('practical_submodule_question_reorder') }}">
                {% for evaluationQuestion in evaluationQuestions %}
                    {% include 'evaluation/_evaluate_mod_evaluationQuestion.html.twig' %}
                {% endfor %}
            </ul>
        {% else %}
            <p>{{ 'evaluationQuestion.empty'|trans }}</p>
        {% endif %}
        <div class="text-end">
            <a href="{{ path('practical_submodule_add_question', {'practicalSubmodule': evaluation.id}) }}" class="btn btn-link btn-sm">{{ mdi('plus') }} {{ 'evaluation.extra.question'|trans }}</a>
        </div>

        <hr>

        <h2 class="mb-3">{{ 'evaluation.extra.evaluators'|trans }}</h2>
        {% if evaluationEvaluators is not empty %}
            <ul id="evaluation_evaluators" class="mod--evaluation-evaluators" data-path="{{ path('practical_submodule_processor_reorder') }}">
                {% for evaluationEvaluator in evaluationEvaluators %}
                    {% include 'evaluation/_evaluate_mod_evaluationEvaluator.html.twig' %}
                {% endfor %}
            </ul>
        {% else %}
            <p>{{ 'evaluationEvaluator.empty'|trans }}</p>
        {% endif %}
        <div class="text-end">
            <a href="{{ path('practical_submodule_add_processor', {'practicalSubmodule': evaluation.id}) }}" class="btn btn-link btn-sm">{{ mdi('plus') }} {{ 'evaluation.extra.evaluator'|trans }}</a>
        </div>

    {% elseif is_user() %}

        <div class="evaluation-assessment-intro">
            <p>{{ 'evaluationAssessment.message.1'|trans({'%questionCount%': questionCount})|raw }}</p>
            <p>{{ 'evaluationAssessment.message.2'|trans|raw }}</p>
            <p>{{ 'evaluationAssessment.message.3'|trans|raw }}</p>
            <div class="d-flex justify-content-center">
                <form action="{{ path('practical_submodule_start_assessment', {'practicalSubmodule': evaluation.id}) }}" method="post">
                    <input type="hidden" name="_csrf_token" value="{{ csrf_token('evaluationAssessment.start') }}"/>
                    <button type="submit" class="btn btn-theme-white bg-blue">{{ 'evaluationAssessment.action.start'|trans }}</button>
                </form>
                {% if assessmentCompleted %}
                    <a href="{{ path('practical_submodule_results', {'practicalSubmodule': evaluation.id}) }}" class="btn btn-theme-white bg-red ms-3">{{ 'button.results'|trans }}</a>
                {% endif %}
            </div>
        </div>

    {% endif %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% if is_granted('ROLE_MODERATOR') %}
        {{ encore_entry_script_tags('axios') }}
        {{ encore_entry_script_tags('sortable') }}
        {{ encore_entry_script_tags('Reorderer') }}
        {{ encore_entry_script_tags('evaluation.questions.sort') }}
        {{ encore_entry_script_tags('evaluation.evaluators.sort') }}
    {% endif %}
{% endblock %}